{% extends "admin/index.html" %}
{% load static %}

{% block content %}
<div class="dashboard-stats" style="display:flex; gap:20px; margin-bottom:20px;">
    <div style="flex:1; background:#4CAF50; color:white; padding:20px; border-radius:10px; text-align:center;">
        <h2>{{ total_candidates }}</h2>
        <p>Total Candidates</p>
    </div>
    <div style="flex:1; background:#2196F3; color:white; padding:20px; border-radius:10px; text-align:center;">
        <h2>{{ total_shifts }}</h2>
        <p>Total Shifts</p>
    </div>
    <div style="flex:1; background:#FF9800; color:white; padding:20px; border-radius:10px; text-align:center;">
        <h2>{{ total_trades }}</h2>
        <p>Total Trades</p>
    </div>
</div>

<!-- Data Management Section -->
<div class="data-management-section" style="background:#f8f9fa; padding:20px; border-radius:10px; margin-bottom:20px; border:1px solid #dee2e6;">
    <h3 style="color:#495057; margin-bottom:15px; font-size:18px;">üóÇÔ∏è Data Management</h3>
    <div style="display:flex; gap:15px; flex-wrap:wrap;">
        
        <!-- Clean Questions Only -->
        <div style="flex:1; min-width:200px;">
            <button onclick="cleanQuestions()" 
                    style="width:100%; padding:12px; background:#17a2b8; color:white; border:none; border-radius:6px; cursor:pointer; font-weight:bold; transition:background 0.3s;"
                    onmouseover="this.style.background='#138496'" 
                    onmouseout="this.style.background='#17a2b8'">
                üóÉÔ∏è Clean Questions & Papers
            </button>
            <p style="font-size:12px; color:#6c757d; margin-top:5px; text-align:center;">
                Delete all questions and question papers only
            </p>
        </div>

        <!-- Clean Exam Data -->
        <div style="flex:1; min-width:200px;">
            <button onclick="cleanExamData()" 
                    style="width:100%; padding:12px; background:#fd7e14; color:white; border:none; border-radius:6px; cursor:pointer; font-weight:bold; transition:background 0.3s;"
                    onmouseover="this.style.background='#e8650e'" 
                    onmouseout="this.style.background='#fd7e14'">
                üßπ Clean Exam Data
            </button>
            <p style="font-size:12px; color:#6c757d; margin-top:5px; text-align:center;">
                Delete exam data, keep user registrations
            </p>
        </div>

        <!-- Clean Everything -->
        <div style="flex:1; min-width:200px;">
            <button onclick="cleanEverything()" 
                    style="width:100%; padding:12px; background:#dc3545; color:white; border:none; border-radius:6px; cursor:pointer; font-weight:bold; transition:background 0.3s;"
                    onmouseover="this.style.background='#c82333'" 
                    onmouseout="this.style.background='#dc3545'">
                ‚ö†Ô∏è Clean Everything
            </button>
            <p style="font-size:12px; color:#6c757d; margin-top:5px; text-align:center;">
                Delete ALL data including registrations
            </p>
        </div>

    </div>
</div>

{{ block.super }}

<script>
function cleanQuestions() {
    if (confirm('‚ö†Ô∏è WARNING: This will delete ALL questions and question papers.\n\nThis action cannot be undone. Are you sure?')) {
        if (confirm('üî¥ FINAL CONFIRMATION: Delete all questions and papers?\n\nType "DELETE QUESTIONS" in the next prompt to confirm.')) {
            var confirmation = prompt('Type "DELETE QUESTIONS" to confirm:');
            if (confirmation === 'DELETE QUESTIONS') {
                window.location.href = '{% url "admin:cleanup_questions" %}';
            } else {
                alert('‚ùå Operation cancelled - incorrect confirmation text.');
            }
        }
    }
}

function cleanExamData() {
    if (confirm('‚ö†Ô∏è WARNING: This will delete all exam-related data but keep user registrations.\n\nThis includes:\n- Questions and papers\n- Exam sessions and results\n- Uploaded files\n\nThis action cannot be undone. Are you sure?')) {
        if (confirm('üî¥ FINAL CONFIRMATION: Delete all exam data but keep users?\n\nType "DELETE EXAM DATA" in the next prompt to confirm.')) {
            var confirmation = prompt('Type "DELETE EXAM DATA" to confirm:');
            if (confirmation === 'DELETE EXAM DATA') {
                window.location.href = '{% url "admin:cleanup_exam_data" %}';
            } else {
                alert('‚ùå Operation cancelled - incorrect confirmation text.');
            }
        }
    }
}

function cleanEverything() {
    if (confirm('üö® DANGER ZONE üö®\n\nThis will delete EVERYTHING:\n- All user registrations\n- All exam data\n- All questions and papers\n- All uploaded files\n- Everything except admin accounts\n\nThis action cannot be undone and will reset the system completely.\n\nAre you absolutely sure?')) {
        if (confirm('üî¥ FINAL WARNING: This will delete ALL DATA including candidate registrations!\n\nType "DELETE EVERYTHING" in the next prompt to confirm.')) {
            var confirmation = prompt('Type "DELETE EVERYTHING" to confirm complete system reset:');
            if (confirmation === 'DELETE EVERYTHING') {
                window.location.href = '{% url "admin:cleanup_everything" %}';
            } else {
                alert('‚ùå Operation cancelled - incorrect confirmation text.');
            }
        }
    }
}
</script>

{% endblock %}
